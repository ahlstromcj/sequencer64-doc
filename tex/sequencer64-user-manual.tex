%-------------------------------------------------------------------------------
% sequencer64-user-manual
%-------------------------------------------------------------------------------
%
% \file        sequencer64-user-manual.tex
% \library     Documents
% \author      Chris Ahlstrom
% \date        2015-11-01
% \update      2016-09-04
% \version     $Revision$
% \license     $XPC_GPL_LICENSE$
%
%     This document provides LaTeX documentation for Sequencer64.
%
%-------------------------------------------------------------------------------

\documentclass[
 11pt,
 twoside,
 a4paper,
 headinclude,
 footinclude,
 final                                 % versus draft
]{article}

\input{docs-structure}                 % specifies document structure and layout

% Replacing normal header/footer with a fancier version.  These two symbols of
% document class were showing up as "unused" in the log file.
%
% headinclude,
% footinclude,
%
% So we add the fancyhdr package, clear the default layout, and set it up for
% our wider pages.

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\fancyheadoffset{0.005\textwidth}
\lhead{Sequencer64 Live MIDI Sequencer}
\chead{}
\rhead{User Manual}
\lfoot{}
\cfoot{\thepage}
\rfoot{}

\makeindex

\begin{document}

\title{Sequencer64 User Manual 0.9.17}
\author{Chris Ahlstrom \\
   (\texttt{ahlstromcj@gmail.com})}
\date{\today}
\maketitle

\begin{figure}[H]
   \centering 
   \includegraphics[scale=0.50]{Sequencer64-0_9_17.png}
\end{figure}

\clearpage                             % moves Contents to next page

\tableofcontents
\listoffigures                         % print the list of figures
\listoftables                          % print the list of tables

% Changes the paragraph style to remove indenting and put a line between each
% paragraph.  This could be moved up into the preamble, but then would
% affect the spacing of the TOC and LOF, LOT noted above.

\setlength{\parindent}{0pt}
\setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}

\section{Introduction}
\label{sec:introduction}

   This document describes how to use \textsl{Sequencer64}
   \cite{sequencer64}, through version 0.9.17,
   using the latest commit from the
   \textbf{master} and \textbf{fixups} branches.
   If one is impatient to get started mastering \textsl{Sequencer64},
   then proceed to \sectionref{subsec:introduction_lets_get_started}.

   \textsl{Sequencer64} fixes some bugs in JACK support, MIDI clocking, and
   JACK Master mode (with code from the \textsl{SooperLooper} 
   and \textsl{Seq32} projects).
   So, overall, JACK and clocking are improved over \textsl{Seq24}.
   However, as user \textsl{stazed} notes on GitHub, there is more that can be
   done (and he has done much with his \textsl{seq32} \cite{seq32} project).

   We've added a few features to make song editing more
   convenient.
   There is now a Pause button and a configuration Pause
   keystroke, which defaults to a period (".").
   Much more editing can be done using keystrokes.

   A shift-left-click on a pattern slot in the pattern window,
   or on a pattern's name or M button in the song editor toggles the armed or
   mute status of all of the \textsl{other} active patterns.
   We've got zoom keys for the editors, current-sequence highlighting,
   a raft of important bug fixes, some optimization, and much more.

   We have contributors to acknowledge.  Please see
   \sectionref{sec:kudos}.

\subsection{Sequencer64: What?}
\label{subsec:what_is_sequencer64}

   \textsl{Sequencer64} is an continuation of of \textsl{Seq24},
   a live-looping sequencer with an interface more like a hardware sequencer
   than the typical software MIDI sequencer.
   \textsl{Sequencer64} has many updates and improvements, and a modestly
   new look, so that a new manual is a necessity.

   \textsl{Seq24} was, a few years back, a very active project, with a
   number of contributors, who have created patches, additional
   functionality, and even ports to Windows.
   We searched assiduously for these updates, and
   incorporated most of them into \textsl{Sequencer64} where feasible.
   There are still some things to be done, including a port to
   Windows/Portmidi.

   \textsl{Sequencer64} is not a synthesizer.  It requires a hardware
   synthesizer, or a software synthesizer such as Timidity \cite{timidity},
   FluidSynth \cite{fluidsynth}, ZynAddSubFX \cite{zynaddsubfx}, Yoshimi
   \cite{yoshimi} \cite{yoshimi2}, AmSynth \cite{amsynth}, Bristol
   \cite{bristol}, and others (see \cite{linuxsynths} for a fairly
   comprehensive list of "Linux" synthesizers).

   \textsl{Sequencer64}, like \textsl{Seq24},
   is meant to work a bit like an Alesis SR16 drum machine,
   which, for some, is a very intuitive and fast way to do MIDI.
   If one has worked with trackers like \textsl{SoundTracker} and
   \textsl{ShakeTracker}, then "you are a tracker guy and it gonna go fast".
   With \textsl{Sequencer64}, one creates several patterns, and then
   combines them.

   Now, unfortunately, \textsl{Seq24} spent some time in limbo
   (2010 was the last major update, with a
   recent update to fix a MIDI clock issue).  There are a number of
   forks for it on \textsl{GitHub}, and some conversions
   to code in other languages, and some patches.
   There is also a fairly extensive port to Windows.
   So, why would we bother creating yet another fork of \textsl{Seq24}?

\subsection{Sequencer64: Why?}
\label{subsec:introduction_seq64_vs_others}

   The first reason to reboot \textsl{Seq24}
   is consolidation of many of the features and fixes that
   it has accumulated in various forks over the years.
   Also, although "feature-complete", additional features would be useful,
   such as support for more
   session managers, still more use of
   keystrokes, work-arounds for the need for two mouse buttons, a more
   up-to-date user-interface framework, bug fixes, beefing up the support
   for the "user" configuration file, and a way to edit parts of the MIDI file
   textually.

   We view \textsl{Seq24} as a kind of "vi" of MIDI editing... spare, lean, and
   powerful.  Without \textsl{Seq24} and its authors,
   \textsl{Sequencer64} would never have come into being.

\subsection{Improvements}
\label{subsec:improvements}

   The following improvements have been made to \textsl{Seq24} for
   \textsl{Sequencer64}.

   \begin{itemize}
      \item A new \textsl{event editor} dialog was added.
         It detailed viewing and editing of MIDI events.
         This editor is basic, but useful.
      \item \textsl{Sequencer64} reads SMF 0 MIDI files.  It splits
         the file into tracks based on channel number.  Each track becomes one
         sequence/pattern in the main window grid.
      \item Some features have been ported from \textsl{Stazed}'s
      \textsl{Seq32} \cite{seq32} project.  Some features can be disabled at
      configure/build time, if desired.
      \begin{itemize}
         \item The chord-generation feature of \textsl{Seq32}.
         \item The pattern-transposing feature.
         \item MIDI song export.
            It allows a song/performance to be exported into a MIDI file
            without \textsl{Sequencer64} loops, so that the performance can be
            played in a standard MIDI sequencer.
         \item The extended undo/redo support of \textsl{Seq32} has been
            ported to \textsl{Sequencer64}.
         \item The ability to split triggers at the nearest snap, instead
            simply splitting them in half.
         \item A large number of other \textsl{Seq32} features have been
            ported, but they are currently commented out until we can test them
            and make sure they are "perfect".
         \begin{itemize}
            \item Enhanced JACK support.
            \item Diverting multi-channel recorded MIDI so that each channel
               is stored in the sequence/pattern configured for that channel
            \item Randomizing MIDI events.
            \item Selection extensions such as selecting odd/even notes, and
            handles on data events..
            \item More feature for controlling transport.
            \item Support for editing the amplitude of data events using a
               low-frequency oscillator (LFO).
         \end{itemize}
      \end{itemize}
      \item One can optionally bring up two song editor windows, to have a view
         of two different parts of a large song while arranging it.
      \item The Set Tempo and Time Signature events of normal MIDI files are
         now processed and incorporated into the user-interface and are saved
         as standard MIDI data.
      \item One can now save the scale, key, and background sequence
         settings to the \textsl{Sequencer64} MIDI file, either globally or
         per-sequence.
      \item In the sequence/pattern and song editors, the window now scrolls to
         keep up with the progress bar for sequences that are longer than the
         width of the sequence editor window.
      \item Additional mouse and keystroke support in the pattern and song
         editor windows:
      \begin{itemize}
         \item Usage of Page Up, Page Down, and Shift Page Up, Shift Page Down,
            to move vertically and horizontally in the pattern and song
            windows.
         \item Moving selected notes or triggers using the arrow keys.
         \item Pasting selected notes (and other events) using the arrow and
            Enter keys.
         \item Additional keystroke support for entering and exiting "paint"
            mode.
         \item Usage of the Mod4/Super/Windows key to keep editing
            (painting) mode enabled after releasing the right mouse button, for
            some of the modern crappy touchpads shipped with "gamer" laptops.
         \item Shift-left-click on a pattern slot (in the pattern editor),
            or on the pattern name or M (mute) (in the song editor)
            to toggle the status of all of the other active slots.
            Useful for listening to a single track by itself.
         \item Right-click on a the virtual keyboard in the pattern editor
            toggles between showing letters/octaves (e.g. "C4") versus
            the MIDI note numbers.  
      \end{itemize}
      \item The "user" configuration is now written to disk, and we will
         add more settings to it as time goes on.  It currently offers the
         long-standing feature of customizable buss, instrument, and controller
         information, plus some customizations of the user-interface, such as
         font and display of the main window's pattern grid.  It also supports
         colored and thicker progress bars and modification of the default 40
         millisecond window redraw rate.
      \item Support for mapping MIDI events to a single MIDI buss for testing
         or simple use cases.
      \item On-going support for handling PPQN values other than the
         default value of 192.  Still not comprehensive, but very usable.
      \item Small improvements in appearance:
      \begin{itemize}
         \item Support for showing empty sequences (i.e. having only meta
            events) in a highlight color (yellow).
         \item Support for showing the currently-focussed (for editing in the
            pattern editor) sequence.  It is highlighted in black-on-cyan if
            not armed, and in cyan-on-black if armed, and the highlighting
            appears in both the pattern and song editors.
         \item Sequences that are shorter than a quarter note are now padded to
            one full measure, for smoother scrolling on the patterns panel.
         \item Modification of the colors of the scale and background sequence
            in the sequence editor to make it easier to see them all.
         \item A new font, enabled at run time, that is bolder and has a
            more modern, anti-aliased look.
         \item Clean, solid lines to replace the dotted lines in the piano-roll
            grids.
         \item Additional zoom values have been added to support the display
            of high PPQN sequences.
         \item An "inverse" or "night" color mode has been added for those
            who find the glare of all-white windows to be uncomfortable.
      \end{itemize}
      \item Consolidated various patches in forks of the \textsl{Seq24}
         project found by searching the web.  Fixes to bugs found while
         refactoring \textsl{Seq24} were also made.  These fixes are noted in
         detail in the project's ROADMAP and contrib/notes/bugs-to-investigate
         files.
      \item More musical scales (harmonic minor, melodic minor,
         whole tone, etc.) have been added.
      \item A pause feature has been added to ALSA-mode playback.  It works
         almost completely, but is still undergoing testing.  It also includes
         a pause keystroke (".") and a pause button.
      \item Internal improvements.
      \begin{itemize}
         \item Provided a new, more MIDI-compliant output format for the MIDI
            files.  The old format can still be read, and, with a "legacy"
            option, be written.
         \item Changed the type of MIDI event container used, which greatly
            speeds up the loading of a MIDI file, especially in debug mode.
%           If the new container reduces the maximum output of the sequencer,
%           we will dump the slow container into a vector container for faster
%           playback.
         \item Note-transpose now also works on aftertouch events.
         \item Non-note events are now copied, moved, or pasted, even if not
            visible, in the pattern editor.
         \item The code was reformatted using \textsl{astyle} and
            personal preferences, and refactored into smaller modules.
         \item Much documentation was added to the code as we figured
            out how it worked.  Generation of Doxygen output (including a PDF
            file) provides a developer's reference manual.
         \item Debian packaging was incorporated into the project to make it
            easier to install without source code.  Bootstrapping and
            packing scripts were added so that other developers can rebuild the
            project from scratch.
      \end{itemize}
      \item New minor features.
      \begin{itemize}
         \item The size of the Patterns Panel (main window) is now locked.
         \item Support for LASH is a run-time or a build option.
         \item Support for reading and writing configuration files from the
            user's \texttt{\$HOME/.config/sequencer64} directory, or,
            optionally, other directories.
      \end{itemize}
   \end{itemize}

   In the future, version 1.0 will be even more object-oriented, hopefully
   faster, and easier to modify.  Eventually, we might get it to build
   for Windows, using MingW, though this is a low priority and a fairly
   significant task.  We've also been asked to incorporate support for a
   scripting language, for OSC (Open Sound Control), and for NSM (the Non
   Session Manager).

\subsection{Document Structure}
\label{subsec:introduction_document_structure}

   The structure of this document follows the user-interface of
   \textsl{Sequencer64}.  The sections are provided in the order
   their contents appear in the user interface of \textsl{Sequencer64}.  To
   help the reader jump around this document, it provides
   multiple links, references, and index entries.

   \textsl{Usage tips}
   \index{tips!documented}
   for each of the functions provided in
   \textsl{Sequencer64} are sprinkled throughout this document.
   Each tip occurs in a section beginning with "\textbf{Tip:}".
   Each tip is provided with an entry in the index, under the
   main topic "tips".

   \textsl{Bug notes}
   \index{bugs!documented}
   for some of the oddities found in \textsl{Sequencer64} are
   sprinkled throughout this document.
   Each bug occurs in a sentence beginning with "\textbf{Bug:}".
   Each bug is provided with an entry in the index, under the
   main topic "bugs".  These bugs are items that we will try to
   fix as time goes on.

   \textsl{"To-do" items}
   \index{todo!documented}
   are also present, again in the same vein.
   Each to-do occurs in a sentence beginning with "\textbf{TODO:}".
   This document currently has a lot of them!

   \textsl{"New" items}
   \index{new!documented}
   are also present, in the same vein.
   New features (post version 0.9.2) will be noted with the tag
   "\textbf{New:}".

\subsection{Let's Get Started!}
\label{subsec:introduction_lets_get_started}

   Let us run \textsl{Sequencer64}, but run it without using \textsl{JACK},
   which complicates the discussion of \textsl{Sequencer64}.  The first
   thing to do is make sure one has no other sound application running
   (unless one wants to risk blocking \textsl{Sequencer64} or hearing two
    sounds simultaneously, depending on one's sound card and ALSA setup).
   Then start \textsl{Sequencer64} so that it uses ALSA for MIDI.  Provide a
   default MIDI file so that all elements of the user interface can come
   into play.  Also use the "\&" character so that we get back to the
   command-line prompt.  Finally, on our system the main synthesizer
   (\textsl{Yoshimi}) comes up on MIDI buss 5, so we add an option to remap
   all events to that buss:

\begin{verbatim}
   $ sequencer64 --bus 5 b4uacuse-seq24.midi &
\end{verbatim}

\begin{figure}[H]
   \centering 
   \includegraphics[scale=0.75]{seq64-first-screen.png}
%  \includegraphics[scale=0.75]{new/seq64_first_screen.png}
   \caption{Sequencer64 Main Screen}
   \label{fig:seq64_main_screen}
\end{figure}

   Then the \textsl{Sequencer64} main window appears, as shown in
   \figureref{fig:seq64_main_screen}.  It has some differences
   from the \textsl{Seq24} main window: the highlighting of
   empty patterns in yellow, a different font, and much more that is not shown.
   All of these items can be configured either at build time or at run
   time (via the "rc" and "user" configuration files or via command-line
   options).

% This Tip needs to be put elsewhere.

   \textbf{Tip:}
   \index{tips!tooltips}
   \index{tooltips}
   As with most user-interfaces, holding the mouse over any button for a
   short period will let one view a short description (tooltip)
   of what it does.

% The following "input" sections are stored in separate files of the same
% name with ".tex" appended.

\rhead{\rightmark}         % shows section number and section name

% Menu

\input{seq64_menu}

% Patterns Panel

\input{seq64_patterns_panel}

% Pattern Editor

\input{seq64_pattern_editor}

% Song Editor

\input{seq64_song_editor}

% Event Editor

\input{seq64_event_editor}

% Tables of keyboard and mouse actions

\input{seq64_kbd_mouse}

% Configuration file

\input{seq64_rc_file}

% User file

\input{seq64_usr_file}

% Man page

\input{seq64_manpage}

% Important Concepts

\input{seq64_concepts}

% Building and debugging Sequencer64

\input{seq64_build}

% Discussion of MIDI formats related to Seq24 and Sequencer64

\input{seq64_midi_formats}

% Acknowledgments

\input{seq64_kudos}

% Discussion of JACK support
%
% \input{seq64_jack}

% Detailed discussion of how internal variables alter the appearance
% of Sequencer64.
%
% \input{seq64_metrics}

\section{Summary}
\label{sec:summary}

   In summary, we can say that you will find \textsl{Sequencer64} intriguing.

   Contact: If you have ideas about \textsl{Sequencer64} or a bug report, please
   email us (at \url{mailto:ahlstromcj@gmail.com}).
   If it's a bug report, please add \textbf{[BUG]} to the Subject, or use the
   GitHub bug-reporting interface.

% References

\input{seq64_references}

\printindex

\end{document}

%-------------------------------------------------------------------------------
% vim: ts=3 sw=3 et ft=tex
%-------------------------------------------------------------------------------
